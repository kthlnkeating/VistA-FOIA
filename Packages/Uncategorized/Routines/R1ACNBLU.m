R1ACNBLU ;SFVAMC/NLS - Select CrossWalk Clinic & Display Blue Box Text
 ;;3.0;Region 1 Appointment Card;;March 23, 2011;Build 9
 D ASK
 S %ZIS="Q",%ZIS("B")="" D ^%ZIS I POP W ! G EXIT
 I $D(IO("Q")) D  G EXIT
 .S ZTDESC="X-Walk PostCard Text",ZTRTN="DQ^R1ACNBLU"
 .F X="Y","VAUTD(","VAUTC(","VAUTC","VAUTD" S ZTSAVE(X)=""
 .D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued, #",ZTSK W !
 .K ZTSK,IO("Q") D HOME^%ZIS
 W !
DQ U IO S POP=0
 S R1ACQ=0,R1ACCLN=""
 I $G(VAUTC)=0 G DQ1 ;One or more specific Clinics
 I $G(VAUTC)=1 G DQ2 ;All X-Walk Clinics
 Q
DQ1 ;One or more specific Clinics
 S (R1ACPG,R1ACFLG)=0,R1ACFLGZ="" D HDR1
 S R1ACQ=0
 F  S R1ACQ=$O(VAUTC(R1ACQ)) Q:'R1ACQ  Q:R1ACFLG=1  Q:R1ACFLGZ  D
 .I R1ACQ>0 S R1ACCLN=$P($G(^SC(R1ACQ,0)),U) W !!,"TEMPLATED TEXT FOR CROSSWALK CLINIC:  ",R1ACCLN
 .D 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
 G EXIT
 Q
DQ2 ;All X-Walk Clinics
 S (R1ACPG,R1ACFLG)=0,R1ACFLGZ="" D HDR1
 S R1ACQ=0
 F  S R1ACQ=$O(^DIZ(612418,R1ACQ)) Q:'R1ACQ  Q:R1ACFLG=1  Q:R1ACFLGZ  D
 .I R1ACQ>0 S R1ACCLN=$P($G(^SC(R1ACQ,0)),U) W !!,"TEMPLATED TEXT FOR CROSSWALK CLINIC:  ",R1ACCLN
 .D 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
 G EXIT
 Q
ASK ;
 F  S DIC="^DIZ(612418,",VAUTSTR="Cross Walk Clinic",VAUTVB="VAUTC",VAUTNI=1 D FIRST^VAUTOMA S:$D(DIRUT)!($D(DTOUT)) R1ACFLG=1 Q
 Q
HDR1 ;
  S R1ACINS="",R1ACINS=$P(^DIC(4,DUZ(2),0),U)
  W !?5,"***  ",R1ACINS," Crosswalk Clinics Templated Text  ***",!
HDR ;
 S R1ACNOW="",Y=DT X ^DD("DD") S R1ACNOW=Y
 W:R1ACPG>0 @IOF S R1ACPG=R1ACPG+1
 W !?40,"Run Date:  ",R1ACNOW,?70,"Page:  ",$G(R1ACPG),!
 F I=1:1:80 W "="
 W !
 Q
CHKL I $Y>(IOSL-4) D RET:($E(IOST,1,2)="C-") Q:R1ACFLGZ  D HDR
 Q
RET K DIR S DIR(0)="E" D ^DIR K DIR(0) I $D(DIRUT) S R1ACFLGZ=1
 Q
1 I $G(^DIZ(612418,R1ACQ,1,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,1,0)) W !?10,"*** Pre-Appt/ACA  [#1] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,1,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,1,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
2 I $G(^DIZ(612418,R1ACQ,3,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,3,0)) W !?10,"*** Comp & Pen  [#2] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,3,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,3,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
3 I $G(^DIZ(612418,R1ACQ,4,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,4,0)) W !?10,"*** Appt - Bring ???  [#3] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,4,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,4,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
4 I $G(^DIZ(612418,R1ACQ,5,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,5,0)) W !?10,"*** Appt Coming Up  [#4] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,5,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,5,R1ACNUM,0)
 .W !,R1ACTXT
 W !
 Q
5 I $G(^DIZ(612418,R1ACQ,6,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,6,0)) W !?10,"***  Phone Consult  [#5] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,6,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,6,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
6 I $G(^DIZ(612418,R1ACQ,7,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,7,0)) W !?10,"*** Annual Means Test: 30/60 day  [#6] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,7,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,7,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
7 I $G(^DIZ(612418,R1ACQ,8,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,8,0)) W !?10,"*** Means Test:  0 day  [#7] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,8,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,8,R1ACNUM,0)
 .W !,R1ACTXT
 W !
 Q
8 I $G(^DIZ(612418,R1ACQ,9,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,9,0)) W !?12,"*** Mobile Svcs Appt  [#8] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,9,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,9,R1ACNUM,0)
 .W !,R1ACTXT
 W !
 Q
9 I $G(^DIZ(612418,R1ACQ,10,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,10,0)) W !?10,"*** Appt Loc Changed Alert  [#9] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,10,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,10,R1ACNUM,0)
 .W !,R1ACTXT
 W !
 Q
10 I $G(^DIZ(612418,R1ACQ,11,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,11,0)) W !?10,"*** No Show - Please Call Us  [#10] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,11,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,11,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
11 I $G(^DIZ(612418,R1ACQ,12,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,12,0)) W !?10,"*** Canceled Appt + New Appt Alert  [#11] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,12,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,12,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
12 I $G(^DIZ(612418,R1ACQ,13,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,13,0)) W !?10,"*** Group Orientation Appt - Alert  [#12] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,13,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,13,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
13 I $G(^DIZ(612418,R1ACQ,14,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,14,0)) W !?10,"*** Cancel Appt/No Reschedule - Alert  [#13] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,14,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,14,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
14 I $G(^DIZ(612418,R1ACQ,15,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,15,0)) W !?10,"*** Fee Based Service at Non-VA Site  [#14] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,15,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,15,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
15 I $G(^DIZ(612418,R1ACQ,16,0))']"" Q
 Q:R1ACFLGZ  D CHKL Q:R1ACFLGZ
 I $D(^DIZ(612418,R1ACQ,16,0)) W !?10,"*** Birthday [#15] ***" S R1ACNUM=0
 F  S R1ACNUM=$O(^DIZ(612418,R1ACQ,16,R1ACNUM)) Q:'R1ACNUM  S R1ACTXT="" D
 .S R1ACTXT=^DIZ(612418,R1ACQ,16,R1ACNUM,0)
 .W !,R1ACTXT
  W !
 Q
EXIT ;
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
 K R1ACFLG,R1ACPG,R1ACCLN,R1ACFLGZ,R1ACINS,DIC,I,R1ACNOW,R1ACNUM,POP,R1ACQ,R1ACTXT,VAUTC,VAUTNI,VAUTSTR,VAUTVB,X,Y
 K %ZIS,%ZIS("B"),DIRUT,DTOUT,ZTDESC,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE
 Q
