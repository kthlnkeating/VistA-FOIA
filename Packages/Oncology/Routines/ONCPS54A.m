ONCPS54A ;Hines OIFO/GWB - Collaborative Staging v0204 conversion ;11/02/11
 ;;2.11;ONCOLOGY;**54**;Mar 07, 1995;Build 10
 ;
 N DISCRIM,EXT,HIST,HIST14,LN,METS,PSITE,SCHNAME,SITE
 N SSF1,SSF2,SSF3,SSF5
 N SSF12,SSF13,SSF19,SSF25
 S SITE=$P($G(^ONCO(165.5,IEN,2)),U,1)
 Q:SITE=""
 S HIST=$$HIST^ONCFUNC(IEN)
 S HIST14=$E(HIST,1,4)
 S PSITE=$TR($$GET1^DIQ(164,SITE,1,"I"),".","")
 S EXT=$P($G(^ONCO(165.5,IEN,"CS")),U,11)
 S LN=$P($G(^ONCO(165.5,IEN,"CS")),U,12)
 S METS=$P($G(^ONCO(165.5,IEN,"CS")),U,3)
 S DISCRIM=$$GET1^DIQ(165.5,IEN,240)
 S SCHEMA=+$$SCHEMA^ONCSAPIS(.ONCSAPI,PSITE,HIST14,DISCRIM)
 Q:SCHEMA<0
 S SCHEMA=SCHNAME
 S SSF1=$P($G(^ONCO(165.5,IEN,"CS")),U,5)
 S SSF2=$P($G(^ONCO(165.5,IEN,"CS")),U,6)
 S SSF3=$P($G(^ONCO(165.5,IEN,"CS")),U,7)
 S SSF5=$P($G(^ONCO(165.5,IEN,"CS")),U,9)
 S SSF12=$P($G(^ONCO(165.5,IEN,"CS2")),U,6)
 S SSF13=$P($G(^ONCO(165.5,IEN,"CS2")),U,7)
 S SSF19=$P($G(^ONCO(165.5,IEN,"CS2")),U,13)
 S SSF25=$P($G(^ONCO(165.5,IEN,"CS2")),U,19)
 ;
 I SITE=67160,SSF25="010" D
 .I ((HIST14>7999)&(HIST14<8153))!((HIST14>8153)&(HIST14<8232))!((HIST14>8242)&(HIST14<8246))!(HIST14=8247)!(HIST14=8248)!((HIST14>8249)&(HIST14<8935))!((HIST14>8939)&(HIST14<9137))!((HIST14>9140)&(HIST14<9583))!((HIST14>9699)&(HIST14<9702)) D
 ..S $P(^ONCO(165.5,IEN,"CS2"),U,19)=982
 ..S $P(^ONCO(165.5,IEN,"CS3"),U,1)=""
 ;
 I $G(SCHEMA)="BileDuctsIntraHepat" D  Q
 .S:EXT=750 $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="EXTENSION (CS) code 750"
 ;
 I $G(SCHEMA)="Bone" D  Q
 .S:(SSF1=998)!(SSF2=998) $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF1 and/or SSF2 codes 998"
 ;
 I $G(SCHEMA)="Breast" D  Q
 .S:SSF19=140 $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF19 code 140"
 ;
 I $G(SCHEMA)="Colon" D  Q
 .S:METS=29 $P(^ONCO(165.5,IEN,"CS"),U,3)="08"
 .S:SSF2="030" $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF2 code 030"
 ;
 ;Schema change
 ;CorpusSarcoma to CorpusCarcinoma
 I ($E(SITE,3,4)=54)!(SITE=67559) D
 .I (HIST14=8950)!(HIST14=8951) D
 ..S $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="Schema change. Review EXTENSION (CS), LYMPH NODES (CS) and SSF1."
 ;
 I $G(SCHEMA)="LacrimalGland" D  Q
 .S:SSF5="001" $P(^ONCO(165.5,IEN,"CS"),U,9)="000"
 .S:SSF5="002" $P(^ONCO(165.5,IEN,"CS"),U,9)=990
 ;
 I $G(SCHEMA)="MelanomaSkin" D  Q
 .S:LN=120 $P(^ONCO(165.5,IEN,"CS"),U,12)=110
 .S:LN=130 $P(^ONCO(165.5,IEN,"CS"),U,12)=151
 .S:(SSF3="000")!(SSF3="020") $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF3 codes 000 or 020"
 ;
 I $G(SCHEMA)="MerkelCellPenis" D  Q
 .S:SSF3="000" $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF3 code 000"
 ;
 I $G(SCHEMA)="MerkelCellScrotum" D  Q
 .S:SSF3="000" $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF3 code 000"
 ;
 I $G(SCHEMA)="MerkelCellSkin" D  Q
 .S:SSF3="000" $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF3 code 000"
 ;
 I $G(SCHEMA)="MerkelCellVulva" D  Q
 .S:LN=110 $P(^ONCO(165.5,IEN,"CS"),U,12)=115
 .S:(METS=11)!(METS=35)!(METS=55)!(SSF3="000") $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="METS AT DX (CS) codes 11, 35 or 55 or SSF3 code 000"
 ;
 I $G(SCHEMA)="Ovary" D  Q
 .S:EXT=300 $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="EXTENSION (CS) code 300"
 ;
 I $G(SCHEMA)="PeritoneumFemaleGen" D  Q
 .S:SSF2=987 $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF2 code 987"
 ;
 I $G(SCHEMA)="Prostate" D  Q
 .S:SSF12="025" $P(^ONCO(165.5,IEN,"CS2"),U,6)=995
 .S:SSF13="025" $P(^ONCO(165.5,IEN,"CS2"),U,7)=995
 .S:(SSF12=995)!(SSF13=995) $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF12 and/or SSF13 codes 995"
 ;
 I $G(SCHEMA)="Rectum" D  Q
 .S:SSF2="030" $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF2 code 030"
 ;
 I $G(SCHEMA)="Scrotum" D  Q
 .S:(SSF12="001")!(SSF12="002")!(SSF12="003")!(SSF12="004")!(SSF12="005") $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF12 codes 001-005"
 ;
 I $G(SCHEMA)="Skin" D  Q
 .S:(SSF12="001")!(SSF12="002")!(SSF12="003")!(SSF12="004") $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="SSF12 codes 001-004"
 ;
 I ($E(SITE,3,4)=54)!(SITE=67559) D
 .I ($E(HIST14)=8950)!($E(HIST14)=8951) S $P(^ONCO(165.5,IEN,"CS3"),U,2)=1,$P(^ONCO(165.5,IEN,"CS3"),U,3)="EXTENSION (CS), LYMPH NODES (CS) and SSF1 (all codes)"
 Q
 ;
CLEANUP ;Cleanup
 K EXT,IEN,LN,METS,ONCSAPI,SCHEMA,SITE
 K SSF1,SSF2,SSF3,SSF5,SSF12,SSF13,SSF25
